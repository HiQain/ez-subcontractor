(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2616],{44054:function(e,t,s){Promise.resolve().then(s.bind(s,32392))},16463:function(e,t,s){"use strict";var a=s(71169);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},32392:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(57437),n=s(2265),r=s(66648),i=s(87138),o=s(16463);function c(){let[e,t]=(0,n.useState)(["","","",""]),[s,c]=(0,n.useState)(59),[l,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(null),[p,f]=(0,n.useState)(!1),g=(0,o.useRouter)(),h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",s=document.createElement("div");s.innerHTML='\n            <div class="toast show" role="alert" aria-live="assertive" aria-atomic="true" style="\n                position: fixed;\n                top: 20px;\n                right: 20px;\n                z-index: 9999;\n                min-width: 300px;\n                background-color: '.concat("success"===t?"#d4edda":"#f8d7da",";\n                color: ").concat("success"===t?"#155724":"#721c24",";\n                border: 1px solid ").concat("success"===t?"#c3e6cb":"#f5c6cb",';\n                border-radius: 8px;\n                padding: 12px 20px;\n                box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n                display: flex;\n                align-items: center;\n                gap: 10px;\n                font-weight: 500;\n            ">\n                <span>').concat("success"===t?"✅":"❌"," ").concat(e,'</span>\n                <button type="button" class="btn-close" style="font-size: 14px; margin-left: auto;" data-bs-dismiss="toast"></button>\n            </div>\n        '),document.body.appendChild(s);let a=setTimeout(()=>{s.parentNode&&s.parentNode.removeChild(s)},4e3),n=s.querySelector(".btn-close");null==n||n.addEventListener("click",()=>{clearTimeout(a),s.parentNode&&s.parentNode.removeChild(s)})};(0,n.useEffect)(()=>{let e=localStorage.getItem("forgotPasswordEmail");if(!e){h("Please enter your email first.","error"),g.push("/auth/forgot-password");return}m(e);let t=setInterval(()=>{c(e=>e>0?e-1:0)},1e3);return()=>clearInterval(t)},[g]);let y=(s,a)=>{if(/^\d*$/.test(a)){let n=[...e];if(n[s]=a.slice(-1),t(n),a&&s<3){let e=document.getElementById("otp-".concat(s+1));e&&e.focus()}}};(0,n.useEffect)(()=>{if(e.every(e=>""!==e)&&!p){let e=setTimeout(()=>{b()},30);return()=>clearTimeout(e)}},[e,p]);let b=async()=>{if(p)return;if(d(""),f(!0),!u){h("Email not found. Please try again.","error"),f(!1);return}if(e.some(e=>""===e)){h("Please enter all OTP digits","error"),f(!1);return}let t=e.join("");try{let e=await fetch("".concat("https://api.ezsubcontractor.com/api/","auth/verify-otp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,otp:t})}),s=await e.json();if(e.ok)localStorage.setItem("verifiedOtp",t),h("OTP verified successfully!"),setTimeout(()=>{g.push("/auth/create-new-password")},1e3);else{let e="Invalid OTP, please try again.";"string"==typeof s.message?e=s.message:Array.isArray(s.message)&&(e=s.message[0]),h(e,"error")}}catch(e){h("Network error. Please check your internet connection.","error")}finally{f(!1)}},x=async()=>{if(!u){h("Email not found. Please go back and try again.","error");return}try{let e=await fetch("".concat("https://api.ezsubcontractor.com/api/","auth/forgot-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u})}),s=await e.json();if(e.ok)c(59),t(["","","",""]),d(""),h("OTP resent successfully!"),setTimeout(()=>{let e=document.getElementById("otp-0");e&&e.focus()},50);else{let e="Failed to resend OTP. Please try again.";"string"==typeof s.message?e=s.message:Array.isArray(s.message)&&(e=s.message[0]),h(e,"error")}}catch(e){h("Network error. Please try again.","error")}},v=e.every(e=>""!==e);return(0,a.jsxs)("section",{className:"hero-sec login login-s1 overflow-hidden position-static",children:[(0,a.jsxs)("div",{className:"image-wrapper",children:[(0,a.jsx)(r.default,{src:"/assets/img/left-image.webp",className:"left-image",alt:"Section Image",width:500,height:800}),(0,a.jsxs)("p",{className:"main-title mb-0",children:["Developed by:"," ",(0,a.jsx)(i.default,{href:"https://designspartans.com/",target:"_blank",className:"text-primary fw-semibold",children:"Design Spartans"})]})]}),(0,a.jsx)("div",{className:"row",children:(0,a.jsx)("div",{className:"col-lg-6 offset-lg-6",children:(0,a.jsx)("div",{className:"content-wrapper",children:(0,a.jsxs)("div",{className:"content mx-auto w-100",children:[(0,a.jsx)(r.default,{src:"/assets/img/icons/logo.webp",width:350,height:100,alt:"Login Logo",style:{maxWidth:"350px"},className:"img-fluid d-block w-100 mx-auto mb-4"}),(0,a.jsx)("div",{className:"fw-semibold fs-2 mb-4 text-center form-title",children:"Verify Email"}),(0,a.jsx)("div",{className:"numbers mb-3 d-flex justify-content-center gap-3",children:e.map((e,t)=>(0,a.jsx)("input",{id:"otp-".concat(t),type:"text",maxLength:1,className:"number ".concat(e?"active":""),value:e,onChange:e=>y(t,e.target.value),inputMode:"numeric",disabled:p,autoComplete:"off"},t))}),(0,a.jsxs)("div",{className:"timer-button d-flex align-items-center justify-content-center mb-2",children:[(0,a.jsx)(r.default,{src:"/assets/img/icons/timer.svg",width:20,height:20,alt:"Timer",loading:"lazy"}),(0,a.jsxs)("div",{className:"content fw-medium ms-2",children:["0:",s.toString().padStart(2,"0")]})]}),0===s&&(0,a.jsxs)("div",{style:{marginBottom:20},className:"detail fw-medium text-center text-gray-light",children:["Didn't receive a code?"," ",(0,a.jsx)("button",{type:"button",onClick:x,className:"fw-semibold text-primary border-0 bg-transparent",style:{textDecoration:"underline"},disabled:p,children:"Resend"})]}),(0,a.jsxs)("div",{className:"buttons-wrapper d-flex align-items-center gap-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>g.push("/auth/forget-password"),className:"btn btn-outline-dark rounded-3 justify-content-center w-100",disabled:p,children:"Back"}),(0,a.jsx)("button",{type:"button",onClick:b,className:"btn btn-primary rounded-3 justify-content-center w-100",disabled:!v||p,style:{opacity:!v||p?.6:1,cursor:!v||p?"not-allowed":"pointer"},children:p?"Verifying...":"Next"})]})]})})})})]})}s(98135)},98135:function(){}},function(e){e.O(0,[2112,4974,2971,7023,1744],function(){return e(e.s=44054)}),_N_E=e.O()}]);